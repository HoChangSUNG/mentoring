### 데이터 전송

- **다른 네트워크와의 통신은 같은 네트워크 내에서의 데이터 전송을 반복**해서 이루어짐
    - PC에서 서버로 가는 네트워크는 PC와 같은 네트워크 상에 있는 라우터로 전송 → 라우터가 같은 네트워크에 있는 라우터에 전송
        
         → … → 데이터가 목적지 네트워크에 있는 라우터에 도달하면 해당 라우터가 서버로 데이터를 전송
  
![KakaoTalk_20230902_191752716](https://github.com/HoChangSUNG/mentoring/assets/76422685/f2762ff0-1f3b-40d3-85e2-9fd1fda25922)
    
- 같은 네트워크 내에서 전송을 위해 사용되는 프로토콜(네트워크 인터페이트층)
    - 이더넷
    - 무선 LAN(Wi Fi)

### **이더넷**

- 네트워크 인터페이스층 프로토콜
- **같은 네트워크 내**의 어떤 이더넷 인터페이스에서부터 다른 이더넷 인터페이스까지 데이터를 전송하는 역할
- 레이어 2 스위치는 이더넷으로 전송하는 데이터에 변경을 가하지 않음 → 레이어2 스위치는 같은 네트워크 내에서 데이터 전송하기 때문(목적지 MAC주소 안바뀜)
- **이더넷 프레임**
    - IP 패킷 + 이더넷 헤더 + FCS(에러 체크)
- **이더넷 헤더 안의 정보**
    - 목적지 MAC 주소
    - 출발지 MAC 주소
    - 타입 코드 : 이더넷으로 운반할 대상의 데이터
        - 이더넷 헤더의 주요 타입 코드 값
            - 0x0800 → IPv4
            - 0x0806 → ARP
            - 0x86DD → IPv6

### MAC 주소

- 이더넷 인터페이스를 특정하기 위한 48비트 주소(16진수로 표기)
    - 이더넷 인터페이스를 왜 특정해야 할까? → 데이터를 전송하려면 이더넷 인터페이스를 특정해야 하기 때문
- MAC 주소는 이더넷 인터페이스에 미리 할당되어 있고, 기본적으로 변경이 불가능
- OUI(전반 24비트, 이더넷 인터페이스 제조사 식별 코드)와 시리얼 넘버(후반 24비트, 각 벤더가 할당)로 구성

### 토폴로지

- 네트워크에서 기기를 연결하는 형태
- 버스형, 스타형, 링형
- **버스형** : 네트워크상의 모든 장치가 하나의 케이블로 연결 → 전송매체를 어떻게 공유할 것인지 제어 방법이 필요 → 그 제어 방법이 CSMA/CD 방식
    - CSMA/CD
        - 데이터를 전송 매체에 먼저 보내는 쪽이 이기는 제어 방식
            - 케이블이 사용 중이면 대기, 케이블이 비어 있으면 데이터를 전송
            - 동시에 여러개의 호스트가 케이블이 비었다고 판단해 데이터를 전송하여 충돌이 발생한 경우 랜덤한 시간 동안 대기한 후 데이터를 전송

### 레이어 2 스위치와 동작 방식

- 이더넷을 이용한 네트워크 하나를 구성하는 기기
    - 액세스 스위치 라고도 부름 → 호스트가 네트워크에 접속하려면 레어어 2 스위치와 접속해야 하기 때문에 네트워크 입구 역할을 한다는 의미에서
    - 스위칭 허브라고 부르는 경우도 존재 → 가정용 제품의 경우
- 수신한 이더넷 프레임을 전송하기 위해, 이더넷 헤더의 MAC 주소를 확인만 하고 전송하기 때문에 수신한 이더넷 프레임을 전혀 변경하지 않고 전송
- **동작 방식**
    1. 수신한 이더넷 프레임의 출발지 MAC 주소를 레이어 2 스위치의 MAC 주소 테이블에 등록
    2. MAC 주소 테이블에서 목적지 MAC 주소를 이용해 전송할 포트를 결정하고, 이더넷 프레임을 포트를 통해 전송(**전송 범위는 같은 네트워크 내에서만**)
        - 목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않으면 , 이더넷 프레임을 플러딩한다.
        - 플러딩 : Unknown 유니케스트 프레임을 수신한 포트를 제외한 모든 포트에 전송하는 것
            - Unknown 유니케스트 프레임 : MAC 주소 테이블에 등록되지 않은 MAC 주소가 목적지로 되어있는 이더넷 프레임
    3. 이더넷 프레임을 수신한 레어어 2 스위치마다 위 과정을 반복
    4. 이더넷 프레임을 수신한 호스트가 이더넷 프레임의 목적지 MAC 주소를 확인
        
        → 자기 앞으로 온 것이면 이더넷 프레임을 수신해 상위 프로토콜의 처리를 수행
        
        → 자기 앞으로 온 것이 아니면 이더넷 프레임을 파기
        
- MAC 주소 테이블 관리
    - MAC 주소 테이블에 저장된 MAC 주소는 영구적으로 저장하지 않고, 제한 시간이 존재 → 접속 포트가 바뀌거나 하는 경우도 있어서 영구적인 것이 아니기 때문
        - 수신한 이더넷 프레임의 목적지 MAC 주소가 등록된 출발지 MAC 주소로 되어 있는 경우 제한 시간이 초기화됨
    - 하나의 포트에 반드시 하나의 (출발지)MAC 주소만 등록된다고 볼 수 없음
        
        → 여러대의 레이어 2 스위치로 연결되어 있는 경우에는 하나의 포트에 여러 개의 (출발지)MAC 주소가 등록될 수 있기 때문
        

### 데이터 송수신

- 전이중 통신
    - 데이터 송신과 수신을 동시에 하는 것
    - 데이터 수신용과 송신용 전송 매체를 나누어서 사용(겉으로 보기에는 UTP 케이블이 한 줄로 되어 있음)
- 반이중 통신
    - 송신과 수신을 동시에 하지 못하고, 서로 전환하면서 처리
    - 버스형 토폴로지인 초기 이더넷이 반 이중 통신
    

### 무선 LAN

- 케이블 없이도 간편하게 LAN을 구축할 수 있는 LAN 기술
- 인프라스트럭처 모드 : 무선 LAN 엑세스 포인트를 경유해 데이터를 주고 받는 것
- 보통 무선 LAN 액세스 포인트는 레이어2 스위치와 접속해 유선 이더넷 네트워크 상의 기기와 통신
- 무선 LAN을 만들기 위해서는 **무선 LAN 엑세스 포인트, 무선 LAN 인터페이스**가 필요
    - 무선 LAN 클라이언트 : 무선 LAN 인터페이스로 무선 LAN 네트워크에 연결된 기기
- 어소시에이션
    - 무선 LAN 액세스 포인트에 연결해 무선 LAN에 연결하는 것(SSID를 지정해서 어소시에이션 함)
    - 방식
        1. 무선 LAN 클라이언트가 액세스 포인트가 내보내는 제어신호(비콘)에서 이용할 수 있는 전파의 주파수(채널)를 찾음
        2. 이용 가능한 채널을 발견하면 SSID를 지정해서 무선 LAN 액세스 포인트에 어소시에이션 요청을 보냄
            - SSID : 무선 LAN의 논리적인 그룹을 식별하는 식별 정보, 미리 무선 LAN 액세스 포인트에는 문자열로 SSID를 지정
        3. 무선 LAN 액세스 포인트는 어소시에이션 응답으로 접속할 수 있는지 알려줌  
           


- 무선 랜의 스루풋은 규격 상 전송 속도의 절반 정도 → 하나의 엑세스 포인트에 접속하는 무선 LAN 클라이언트가  전파를 돌려쓰기 때문
- CSMA/CA
    - 엑세스 포인트에 접속한 무선 LAN 클라이언트들이 데이터를 전송할 때 충돌하지 않도록 제어
    - 전파를 통해 데이터를 빨리 보낸 쪽이 이기는 방식
    - 동작 방식
        1. 전파가 이용 중인지 확인(Carrier Sense)
            - 액세스 포인트에 어소시에이션했을 때 채널을 알고 있어 그 채널의 전파를 검출해 데이터를 전송하려고 할 때, 전파가 이용 중인지 아닌지 확인
        2. 랜덤 시간 대기(Collision Avoidance)
            - 전파가 이용 중이 아니라면 바로 송신하지 않고, 랜덤 시간 동안 대기 → 복수의 클라이언트가 동시에 전파를 미사용으로 판단해 데이터를 곧바로 송신하기 시작하면 충돌 발생 가능성 높아서
        3. 데이터 송신
            - 랜덤 시간 동안 대기했는데 전파가 미사용이면, 데이터를 전파에 실어 송신
            - 무선 LAN 통신에서는 데이터를 수신했으면 수신 확인 응답으로 ACK를 반환
        ![KakaoTalk_20230904_194845756](https://github.com/HoChangSUNG/mentoring/assets/76422685/b6651c40-71f8-4fed-9fbe-b8e517156296)  
        → 이런 방식으로 제어하여 무선 LAN 클라이언트가 데이터 보내려고 할 때 대기 시간이 길어지고 스루풋이 저하됨 

- 무선 LAN 보안
    - 인증 : 무선 LAN 엑세스 포인트에 정식 사용자만 접속할 수 있게 함
    - 암호화 : 무선 LAN으로 송수신하는 데이터를 암호화해서 도청해도 의미 없게 함
