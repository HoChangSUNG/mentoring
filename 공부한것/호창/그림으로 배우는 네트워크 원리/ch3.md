# Ch3 네트워크의 공통 언어 TCP/IP

### **TCP/IP**

- TCP와 IP를 중심으로 하는 프로토콜 집합
- 네트워크를 통해 통신하기 위한 기능을 계층화하고 복수의 프로토콜을 조합
- 계층
    - **네트워크 인터페이스 층**
        - 같은 네트워크 내 인터페이스 간 데이터 전송 역할
            - 하나의 네트워크 → 라우터, 레어어 3 스위치로 구분되는 범위 또는 레이어 2 스위치로 구성하는 범위
        - 주요 프로토콜 : 이더넷, 무선 LAN(Wi-Fi), PPP 등
    - **인터넷층**
        - 엔드투엔드 통신(원격지 네트워크간 데이터 전송) 역할
        - 주요 프로토콜 : IP,ICMP,ARP 등
            - 엔드투엔드 통신에 사용 → IP
            - IP를 도와주는 프로토콜 → ARP,ICMP
    - **트랜스포트층**
        - 데이터를 적절한 애플리케이션에 배분하는 역할
        - 주요 프로토콜 : TCP/UDP
            - TCP → 신뢰성 확보, 데이터의 분할과 조립, 데이터 재전송 제어, 데이터의 순서 제어 기능 사용 가능
    - **애플리케이션층**
        - 애플리케이션에서 다루는 데이터 형식과 처리 순서 등을 결정하는 역할
        - HTTP, SMTP, POP3, DHCP, DNS 등
            - DHCP, DNS → 애플리케이션에서 이용하지 않고, 애플리케이션의 통신을 준비하기 위한 프로토콜
    
    ※ 네트워크 인터페이스 층을 제외한 계층은 통신 상대와 동일한 프로토콜을 선택해야 함
    
    - 네트워크 인터페이스 층은 무선 LAN(WI-FI), 이더넷과 같이 서로 다른 프로토콜을 사용해도 됨
    

### **캡슐화와 역캡슐화**

**헤더**

- 프로토콜에서 각각의 기능을 실현하기 위한 제어 정보

**캡슐화**

- 각 프로토콜에서 데이터 전송 시 헤더를 추가하는 것

**역캡슐화**

- 프로토콜이 헤더를 바탕으로 처리를 하고, 헤더를 제거해 다른 프로토콜에 처리를 넘기는 것

**데이터 송신 측**

- 웹 브라우저의 데이터에 HTTP 헤더로 캡슐화 → TCP 헤더가 추가 → IP 헤더 추가 → 이더넷 헤더+ FCS 추가
- TCP/IP 계층을 위에서부터 아래로 따라가며 각 프로토콜 헤더를 추가하고, 이더넷에 규격에 대응하는 물리적 신호로 변환해 전송 매체로 데이터 전달

**데이터 수신 측**

- 수신한 물리적인 신호를 원래 데이터로 되돌림
- 이더넷 헤더를 참조해 데이터 확인, FCS로 데이터 오류 검사 → 이더넷 헤더,FCS 제거 후 IP 계층에 데이터 전달 → IP 헤더 이용해 데이터 처리 후 IP 헤더 제거→ TCP 헤더를 참조해 어느 애플리케이션 데이터인지 확인 후 TCP 헤더를 제거하고 애플리케이션으로 데이터 넘김  → HTTP 헤더를 이용해 데이터 처리
- TCP/IP 계층을 아래에서 위로 따라가며 헤더를 참조해 프로토콜 처리

### TCP/IP 계층별 데이터 부르는 방법

- 애플리케이션 층 : 메시지 → HTTP 메시지(웹브라우저 데이터 + HTTP 헤더)
- 트랜스포트 층 : 세그먼트(TCP), 데이터 그램(UDP) → TCP 세그먼트(HTTP 메시지 + TCP 헤더)
- 인터넷층 : 패킷 또는 데이터 그램(=IP 패킷, IP 데이터 그램) → IP 패킷(TCP 세그먼트 + IP 헤더)
- 네트워크 인터페이스층 : 프레임 → 이더넷 프레임(IP 패킷 + 이더넷 헤더 + FCS)

- 라우터 → 인터넷층 네트워크 기기, IP 패킷을 적절히 전송하는 역할
- 레이어 2 스위치 → 네트워크 인터페이스 층에서 동작하는 기기, 이더넷 프레임을 전송하는 역할

### IP

- 엔드투엔드 통신 역할
- IP 헤더에 IP 주소(출발지, 목적지 주소)를 포함해 데이터 전송
- IP로 전송하는 데이터 → 애플리케이션 데이터에 애플리케이션층 프로토콜의 헤더와 트랜스포트층 프로토콜 헤더 추가된 것
- 목적지가 다른 네트워크에 존재할 경우 → 라우터가 라우팅

### IP 주소

- TCP/IP에서 통신 상대가 되는 호스트를 식별하기 위한 식별 정보, TCP/IP 통신에서 반드시 IP주소 지정해야 함
- 호스트 내부에서 인터페이스와 IP 프로토콜 부분을 연관지어 IP주소를 설정 → IP 주소는 호스트 자체가 아니라 정확하게는 호스트의 인터페이스를 식별
- 표기
    - 도트형 10진 표기 : 0~255 사이의 숫자를 .으로 구분해 4개 나열하는 형태
- **목적지 개수에 따른 전송 방식 3가지**
    - 유니캐스트 : 단 하나의 목적지에 데이터 전송하는 것
        - 유니케스트로 여러개의 목적지 주소에 데이터 전송 시 목적지 개수만큼 데이터 전송을 반복해야 해서 비효율적
        - 따라서 **완전히 같은 데이터를 복수의 주소로 효율적으로 전송하기 위해 브로드캐스트, 멀티캐스트 사용**
        - IP 주소 : 네트워크부 + 호스트부
    - 브로드캐스트 : 같은 네트워크 상의 모든 호스트에 데이터 전송하는 것
        - IP주소 : 32비트가 모두 1, 255.255.255
    - 멀티캐스트 : 특정 그룹에 포함되는 호스트에 데이터 전송하는 것(멀티 캐스트 그룹에 포함되느 호스트가 반드시 같은 네트워크라고 할 수는 없음)
        - IP주소 : 224.0.0.0 ~ 239.255.255.255
            - 224.0.0.2 → 같은 네트워크 상의 모든 라우터
        

### 네트워크부와 호스트부

- 네트워크부 → 네트워크를 식별
- 호스트부 → 네트워크 내 호스트를 식별

### 서브넷 마스크

- IP주소에서 네트워크부와 호스트부를 나누어주는 것
- 연속한 1 → 네트워크부, 연속한 0 → 호스트부
- 표기
    - 8비트씩 10진수로 변환하고 .으로 구분
    - 프리픽스 표기 : / 뒤에 연속한 1의 개수로 표기(네트워크부), 192.168.1.0/24 → 24비트가 네트워크부, 8비트가 호스트부
- 네트워크 주소 : IP주소에서 호스트부를 모두 비트 0으로 채운 주소
- 브로드캐스트 주소 : IP주소에서 호스트부를 모두 비트 1로 채운 주소

### 네트워크에 접속하기 위한 단계

- 물리적인 접속 : LAN 케이블을 삽입하는 등 물리적인 신호를 주고받을 수 있게 하는 것
- 논리적인 접속 : 인터페이스에 IP 주소를 설정하는 것
